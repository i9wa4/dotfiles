# Postman Configuration
# File-based communication daemon for tmux panes

[postman]
a2a_version = "1.0"
entry = "concierge"
ping_every = 30
startup_delay_seconds = 10
reminder_interval = 5  # Send reminder after 5 messages (0 = disabled)
message_header = """
üì¨ Message from {from_node}
Inbox: .postman/inbox/{node}/
"""
message_footer = """
---
Âá¶ÁêÜÂæå„ÅØ inbox ‚Üí read/ „Å´ÁßªÂãï„Åô„Çã„Åì„Å®„ÄÇ
"""

# Reply instruction (used in notifications and pings)
reply_command = "uv run ~/ghq/github.com/i9wa4/dotfiles/bin/postman.py draft --to <recipient>"

# Ping message template
ping_template = """
üì¨ [PING] Status check

You are: {node}
{template}

{talks_to_line}

Active nodes: {active_nodes}

## Reply

{reply_command}
Then: mv .postman/draft/xxx.md .postman/post/
{message_footer}
"""

# Observer digest template
digest_template = """
üìã Digest: New messages

Action: Review message contents for code changes or status updates.

{digest_items}
"""

# Draft message template
draft_template = """---
jsonrpc: "2.0"
method: task/create
id: {msg_id}
params:
  from: {sender}
  to: {recipient}
  timestamp: {timestamp}
---

## Content


{message_footer}
"""

edges = [
  "concierge --> orchestrator --> worker",
  "orchestrator --> observer-claude-1",
  "orchestrator --> observer-claude-2",
  "orchestrator --> observer-codex-1",
  "orchestrator --> observer-codex-2",
]

[concierge]
on_join = "I'm postman. You are the concierge - user's interface!"
template = """
# CONCIERGE (READONLY)

- User's interface - receive requests and clarify requirements
- Delegate to orchestrator for task execution
"""

[orchestrator]
on_join = "I'm postman. You are the /orchestrator !"
template = """
# ORCHESTRATOR (READONLY)

- Delegate tasks to workers (NEVER Edit/Write directly)
- Consult observers before planning
"""

[worker]
on_join = ""
template = """
# WORKER (WRITABLE)

- Execute assigned tasks
- Report issues to observer
"""

[observer-claude-1]
is_observer = true
on_join = ""
template = """
# OBSERVER (READONLY)

- Monitor and review all activities
- Report concerns to relevant nodes
"""

[observer-claude-2]
is_observer = true
on_join = ""
template = """
# OBSERVER (READONLY)

- Monitor and review all activities
- Report concerns to relevant nodes
"""

[observer-codex-1]
is_observer = true
on_join = ""
template = """
# OBSERVER (READONLY)

- Monitor and review all activities
- Report concerns to relevant nodes
"""

[observer-codex-2]
is_observer = true
on_join = ""
template = """
# OBSERVER (READONLY)

- Monitor and review all activities
- Report concerns to relevant nodes
"""
